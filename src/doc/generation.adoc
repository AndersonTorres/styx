== Site Generation

Site generation consists in a call to <<lib.generation.generateSite>>, and the preparation of its arguments.

[source, nix]
.Standard call to generateSite
----
pagesList = pagesToList { iherit pages; };

site = generateSite { inherit conf files pagesList; }
----

It is possible to set default attributes to every page set during the `pages` attribute by using the `default` argument of the <<lib.generation.pagesToList>> function.

A typical example is setting a default layout to every page set that do not declares one.

[source, nix]
.Setting a default layout to every page set
----
pagesList = lib.pagesToList {
  inherit pages;
  default = { layout = templates.layout; };
};
----

NOTE: Styx expects the site to be rendered in the `site` attribute of the main set.


=== Substitutions

Subtitutions are a way to pass variables from `site.nix` in markup or static files.

Substitutions are a set that is passed to the `generateSite` function. Any value of set will be replaced in the markup or static files that `generateSite` outputs.

To be replaced, the variable as to be surrouded by `@`, for example `@siteUrl@`.

[source, nix]
.Simple substitution set
----
{
  siteUrl = conf.siteUrl;
}
----

[source, markdown]
.Using a substitution in a markdown file
----
Learn more in the [Styx 0.1.0 Documentation](@siteUrl@/documentation-v0-1-0.html).
----

[source, css]
.Using a substitution in a css file
----
background: url(@siteUrl@/images/foo.png);
----

TIP: Substitutions are specially useful for resolving in-site links with `conf.siteUrl`, but they can also be used with sass or less to externalize css variables in `conf.nix`.

=== Special files

Styx automatically convert `sass`, `scss` and `less` files to css during site generation.

=== Hooks

`generateSite` provide two hooks to customize the site generation process:

- `preGen`: A string or multiline string with shell commands to run before generating the site.
- `postGen`: A string or multiline string with shell commands to run after generating the site.

